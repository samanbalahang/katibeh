window.wp=window.wp||{},window.communityEventsData=window.communityEventsData||{},jQuery((function(e){window.ajaxWidgets=["wpp_dashboard_primary"],window.ajaxPopulateWidgets=function(t){function n(t,n){var o,i=e("#"+n+" div.inside:visible").find(".widget-loading");i.length&&(o=i.parent(),setTimeout((function(){o.load(ajaxurl+"?action=wpp-dashboard-widgets&widget="+n+"&pagenow="+pagenow,"",(function(){o.hide().slideDown("normal",(function(){e(this).css("display","")}))}))}),500*t))}t?(t=t.toString(),-1!==e.inArray(t,ajaxWidgets)&&n(0,t)):e.each(ajaxWidgets,n)},ajaxPopulateWidgets(),e(document).on("postbox-toggled",(function(e,t){-1!==ajaxWidgets.indexOf(t.id)&&(wppDashboardSlider&&wppDashboardSlider.update(),ajaxPopulateWidgets())}))})),jQuery((function(e){"use strict";var t,n=window.communityEventsData,o=wp.date.dateI18n,i=wp.date.format,a=wp.i18n.sprintf,s=wp.i18n.__,r=wp.i18n._x;t=window.wp.communityEvents={initialized:!1,model:null,init:function(){if(!t.initialized){var o=e("#community-events");e(".community-events-errors").attr("aria-hidden","true").removeClass("hide-if-js"),o.on("click",".community-events-toggle-location, .community-events-cancel",t.toggleLocationForm),o.on("submit",".community-events-form",(function(n){var o=e("#community-events-location").val().trim();n.preventDefault(),o&&t.getEvents({location:o})})),n&&n.cache&&n.cache.location&&n.cache.events?t.renderEventsTemplate(n.cache,"app"):t.getEvents(),t.initialized=!0}},toggleLocationForm:function(t){var n=e(".community-events-toggle-location"),o=e(".community-events-cancel"),i=e(".community-events-form"),a=e();"object"==typeof t&&(a=e(t.target),t="true"===n.attr("aria-expanded")?"hide":"show"),"hide"===t?(n.attr("aria-expanded","false"),o.attr("aria-expanded","false"),i.attr("aria-hidden","true"),a.hasClass("community-events-cancel")&&n.trigger("focus")):(n.attr("aria-expanded","true"),o.attr("aria-expanded","true"),i.attr("aria-hidden","false"))},getEvents:function(t){var o,i=this,a=e(".community-events-form").children(".spinner");(t=t||{})._wpnonce=n.nonce,t.timezone=window.Intl?window.Intl.DateTimeFormat().resolvedOptions().timeZone:"",o=t.location?"user":"app",a.addClass("is-active"),wp.ajax.post("get-community-events",t).always((function(){a.removeClass("is-active")})).done((function(e){"no_location_available"===e.error&&(t.location?e.unknownCity=t.location:delete e.error),i.renderEventsTemplate(e,o)})).fail((function(){i.renderEventsTemplate({location:!1,events:[],error:!0},o)}))},renderEventsTemplate:function(o,i){var r,c,d=e(".community-events-toggle-location"),l=e("#community-events-location-message"),m=e(".community-events-results");o.events=t.populateDynamicEventFields(o.events,n.time_format),c={".community-events":!0,".community-events-loading":!1,".community-events-errors":!1,".community-events-error-occurred":!1,".community-events-could-not-locate":!1,"#community-events-location-message":!1,".community-events-toggle-location":!1,".community-events-results":!1},o.location.ip?(l.text(s("Attend an upcoming event near you.")),o.events.length?(r=wp.template("community-events-event-list"),m.html(r(o))):(r=wp.template("community-events-no-upcoming-events"),m.html(r(o))),c["#community-events-location-message"]=!0,c[".community-events-toggle-location"]=!0,c[".community-events-results"]=!0):o.location.description?(r=wp.template("community-events-attend-event-near"),l.html(r(o)),o.events.length?(r=wp.template("community-events-event-list"),m.html(r(o))):(r=wp.template("community-events-no-upcoming-events"),m.html(r(o))),"user"===i&&wp.a11y.speak(a(s("City updated. Listing events near %s."),o.location.description),"assertive"),c["#community-events-location-message"]=!0,c[".community-events-toggle-location"]=!0,c[".community-events-results"]=!0):o.unknownCity?(r=wp.template("community-events-could-not-locate"),e(".community-events-could-not-locate").html(r(o)),wp.a11y.speak(a(s("We couldn’t locate %s. Please try another nearby city. For example: Kansas City; Springfield; Portland."),o.unknownCity)),c[".community-events-errors"]=!0,c[".community-events-could-not-locate"]=!0):o.error&&"user"===i?(wp.a11y.speak(s("An error occurred. Please try again.")),c[".community-events-errors"]=!0,c[".community-events-error-occurred"]=!0):(l.text(s("Enter your closest city to find nearby events.")),c["#community-events-location-message"]=!0,c[".community-events-toggle-location"]=!0),_.each(c,(function(t,n){e(n).attr("aria-hidden",!t)})),d.attr("aria-expanded",c[".community-events-toggle-location"]),o.location&&(o.location.ip||o.location.latitude)?(t.toggleLocationForm("hide"),"user"===i&&d.trigger("focus")):t.toggleLocationForm("show")},populateDynamicEventFields:function(n,i){var a=JSON.parse(JSON.stringify(n));return e.each(a,(function(e,n){var a=t.getTimeZone(1e3*n.start_unix_timestamp);n.user_formatted_date=t.getFormattedDate(1e3*n.start_unix_timestamp,1e3*n.end_unix_timestamp,a),n.user_formatted_time=o(i,1e3*n.start_unix_timestamp,a),n.timeZoneAbbreviation=t.getTimeZoneAbbreviation(1e3*n.start_unix_timestamp)})),a},getTimeZone:function(e){var n=Intl.DateTimeFormat().resolvedOptions().timeZone;return void 0===n&&(n=t.getFlippedTimeZoneOffset(e)),n},getFlippedTimeZoneOffset:function(e){return-1*new Date(e).getTimezoneOffset()},getTimeZoneAbbreviation:function(e){var n,o=new Date(e).toLocaleTimeString(void 0,{timeZoneName:"short"}).split(" ");if(3===o.length&&(n=o[2]),void 0===n){var i=t.getFlippedTimeZoneOffset(e),a=-1===Math.sign(i)?"":"+";n=r("GMT","Events widget offset prefix")+a+i/60}return n},getFormattedDate:function(e,t,n){var c=s("l, M j, Y"),d=s("%1$s %2$d–%3$d, %4$d"),l=s("%1$s %2$d – %3$s %4$d, %5$d");return t&&i("Y-m-d",e)!==i("Y-m-d",t)?i("Y-m",e)===i("Y-m",t)?a(d,o(r("F","upcoming events month format"),e,n),o(r("j","upcoming events day format"),e,n),o(r("j","upcoming events day format"),t,n),o(r("Y","upcoming events year format"),t,n)):a(l,o(r("F","upcoming events month format"),e,n),o(r("j","upcoming events day format"),e,n),o(r("F","upcoming events month format"),t,n),o(r("j","upcoming events day format"),t,n),o(r("Y","upcoming events year format"),t,n)):o(c,e,n)}};e("#wpp_dashboard_primary").is(":visible")?t.init():e(document).on("postbox-toggled",(function(n,o){var i=e(o);"wpp_dashboard_primary"===i.attr("id")&&i.is(":visible")&&t.init()}))}));const slidesContainer=document.getElementById("wpp_sponsorship"),sponsorshipGuid=document.getElementById("sponsorship-guide"),wppsPlaceholder=document.getElementById("wpp_sponsorship_placeholder"),wppsQuestion=document.querySelector("#sponsorship-guide .question"),sponsorshipUl=document.querySelector("#sponsorship-guide ul");async function wppInitSponsors(){try{const e=Object.values(sponsors);wppsPlaceholder.remove(),createSlides(e),new KeenSlider(slidesContainer,{loop:!0,duration:5e3,controls:!0,indicators:!0})}catch(e){console.error("Error fetching slides:",e)}}function createSlides(e){e.forEach((e=>{const t=document.createElement("div");t.classList.add("keen-slider__slide"),t.innerHTML='<a href="'+e.link+'" target="_blank"><img src="'+e.image_url+'" alt="'+e.image_alt+'" loading="lazy"></a>',slidesContainer.appendChild(t)})),e.length>1&&initWPPSSlider()}function initWPPSSlider(){window.wppDashboardSlider=new KeenSlider(slidesContainer,{rtl:getComputedStyle(slidesContainer).direction,loop:!0,duration:3e3,controls:!0,indicators:!0},[wppsNavigation,e=>{let t,n=!1;function o(){clearTimeout(t)}function i(){clearTimeout(t),n||(t=setTimeout((()=>{e.next()}),4e3))}e.on("created",(()=>{e.container.addEventListener("mouseover",(()=>{n=!0,o()})),e.container.addEventListener("mouseout",(()=>{n=!1,i()})),i()})),e.on("dragStarted",o),e.on("animationEnded",i),e.on("updated",i)}])}function wppsNavigation(e){let t,n,o,i;function a(a){!function(n){if(n){const e=t.parentNode;for(;t.firstChild;)e.insertBefore(t.firstChild,t);return void s(t)}t=r("navigation-wrapper"),e.container.parentNode.prepend(t),t.appendChild(e.container)}(a),function(o){if(o)return void s(n);n=r("dots"),e.track.details.slides.forEach(((t,o)=>{const i=r("dot");i.addEventListener("click",(()=>e.moveToIdx(o))),n.appendChild(i)})),t.appendChild(n)}(a),function(n){if(n)return s(o),void s(i);o=r("arrow arrow--left"),o.addEventListener("click",(()=>e.prev())),i=r("arrow arrow--right"),i.addEventListener("click",(()=>e.next())),t.appendChild(o),t.appendChild(i)}(a)}function s(e){e.parentNode.removeChild(e)}function r(e){const t=document.createElement("div");return e.split(" ").forEach((e=>t.classList.add(e))),t}function c(){let t=e.track.details.rel;0===t?o.classList.add("arrow--disabled"):o.classList.remove("arrow--disabled"),t===e.track.details.slides.length-1?i.classList.add("arrow--disabled"):i.classList.remove("arrow--disabled"),Array.from(n.children).forEach((function(e,n){n===t?e.classList.add("dot--active"):e.classList.remove("dot--active")}))}e.on("created",(()=>{a(),c()})),e.on("optionsChanged",(()=>{console.log(2),a(!0),a(),c()})),e.on("slideChanged",(()=>{c()})),e.on("destroyed",(()=>{a(!0)}))}wppInitSponsors(),wppsQuestion.addEventListener("click",(function(e){sponsorshipUl.classList.toggle("show"),e.stopPropagation()})),document.addEventListener("click",(function(e){sponsorshipGuid.contains(e.target)||sponsorshipUl.classList.remove("show")}));
